# PythonDocker - Руководство по использованию

## Описание

PythonDocker - это инструмент для запуска старых Python скриптов (включая Python 2.x) в изолированных виртуальных окружениях. Программа автоматически определяет необходимую версию Python, скачивает и устанавливает её, затем создает изолированное окружение и запускает скрипт. **Работает без Docker!**

## Установка

### Требования

- Python 3.7 или выше (для запуска программы)
- Доступ к интернету для скачивания версий Python (при первом использовании)
- Достаточно места на диске (~100-200 МБ на версию Python)
- **Docker НЕ требуется!**

### Установка пакета

```bash
# Установка в режиме разработки
pip install -e .

# Или обычная установка
python setup.py install
```

## Использование

### Базовые команды

```bash
# Автоматическое определение версии Python из скрипта
pythondocker script.py

# Указать версию Python вручную
pythondocker script.py --python 2.7

# Запуск с зависимостями из requirements.txt
pythondocker script.py --requirements requirements.txt

# Передача аргументов скрипту
pythondocker script.py --args arg1 arg2 arg3

# Установка переменных окружения
pythondocker script.py --env KEY1=value1 KEY2=value2

# Подробный вывод (для отладки)
pythondocker script.py --verbose
```

### Примеры

#### Пример 1: Запуск Python 2 скрипта

Создайте файл `old_script.py`:

```python
#!/usr/bin/env python2.7
print "Hello from Python 2.7!"
```

Запустите:

```bash
pythondocker old_script.py
```

#### Пример 2: Запуск с зависимостями

Если у вас есть файл `requirements.txt`:

```txt
requests==2.28.0
numpy==1.21.0
```

Запустите:

```bash
pythondocker script.py --requirements requirements.txt
```

#### Пример 3: Запуск с аргументами

```bash
pythondocker process_data.py --args input.txt output.txt
```

#### Пример 4: Запуск с переменными окружения

```bash
pythondocker script.py --env API_KEY=secret123 DEBUG=true
```

## Как работает определение версии Python

PythonDocker определяет версию Python следующими способами (в порядке приоритета):

1. **Shebang строка** - проверяет первую строку файла:
   ```python
   #!/usr/bin/env python2.7
   ```

2. **Комментарии** - ищет упоминания версии в комментариях:
   ```python
   # Requires Python 2.7
   # Python version: 2.7
   ```

3. **Анализ синтаксиса** - определяет признаки Python 2:
   - `print` без скобок
   - `xrange()` вместо `range()`
   - `dict.iteritems()`, `dict.iterkeys()`, `dict.itervalues()`
   - `raw_input()` вместо `input()`
   - `unicode()` функция
   - `basestring` тип
   - и другие

4. **По умолчанию** - если версия не определена, используется Python 3.11

## Поддерживаемые версии Python

PythonDocker поддерживает все версии Python, доступные в официальных Docker образах:

- **Python 2.x**: 2.7 (последняя версия Python 2)
- **Python 3.x**: 3.6, 3.7, 3.8, 3.9, 3.10, 3.11, 3.12, 3.13+

## Структура проекта

```
pythondocker/
├── pythondocker/
│   ├── __init__.py              # Инициализация пакета
│   ├── version_detector.py      # Определение версии Python
│   ├── python_installer.py      # Скачивание и установка версий Python
│   ├── environment_manager.py   # Управление виртуальными окружениями
│   └── cli.py                   # CLI интерфейс
├── examples/                # Примеры скриптов
│   ├── python2_example.py
│   └── python3_example.py
├── setup.py                 # Установочный файл
├── requirements.txt         # Зависимости (пустой)
├── README.md                # Документация на английском
└── USAGE_RU.md             # Это руководство
```

## Решение проблем

### Python не скачивается

Если версия Python не скачивается:

1. Проверьте подключение к интернету
2. Убедитесь, что у вас достаточно места на диске
3. Проверьте права доступа к директории `~/.pythondocker/`
4. Попробуйте использовать системный Python: программа автоматически попытается найти нужную версию в системе

### Версия Python не найдена

Если программа не может найти нужную версию Python:

1. Программа автоматически попытается скачать её с python.org
2. Если скачивание не удалось, проверьте, доступна ли версия для вашей платформы
3. Для некоторых старых версий может потребоваться ручная установка

### Скрипт не запускается

Если скрипт не запускается:

1. Используйте флаг `--verbose` для подробного вывода
2. Проверьте, что скрипт существует и доступен для чтения
3. Убедитесь, что версия Python указана правильно

## Разработка

Для разработки установите пакет в режиме разработки:

```bash
pip install -e .
```

Затем вы можете редактировать код и изменения будут применяться автоматически.

## Лицензия

MIT License
